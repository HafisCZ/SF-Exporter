<!DOCTYPE html>
<html lang="en">
    <head>
        <title>SFTools - Calendar</title>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="res/favicon.png"/>

        <link rel="stylesheet" href="css/pages/calendar.css"/>

        <script src="vendor/js/jquery.3.4.1.min.js"></script>
        <script src="vendor/js/semantic.min.js"></script>

        <script src="js/enum.js"></script>
        <script src="js/util.js"></script>

        <script src="js/plugins.js"></script>
        <script src="js/idle/idle.js"></script>

        <script src="js/core/util.js"></script>
        <script src="js/core/models.js"></script>
        <script src="js/core/core.js"></script>
        <script src="js/core/idb.js"></script>
        <script src="js/core/ast.js"></script>
        <script src="js/stats/settings.js"></script>
        <script src="js/changelog.js"></script>
        <script src="js/views.js"></script>
        <script src="js/editor.js"></script>
        <script src="js/sim/base.js"></script>
        <script src="js/pets/pets.js"></script>

        <script src="endpoint/endpoint.js"></script>
    </head>
    <body class="inverted">
        <div class="ui fixed inverted borderless huge menu">
            <div class="header item"><a href="index.html">SFTools</a></div>
        </div>

        <div class="ui main inverted container">
            <div class="ui five columns stackable grid" id="pet-grid">

            </div>
        </div>

        <script>
            Site.ready(null, function () {
                const $petGrid = $('#pet-grid');

                const PET_COLORS = [
                    '#A596CE',
                    '#E9D067',
                    '#ADC35A',
                    '#FDA700',
                    '#60CDEF'
                ];
                
                const now = new Date();
                const entries = [];

                for (let index = 0; index < 100; index++) {
                    const { location, next: [start, end], time, special } = PetData[index];

                    const availableNow = start <= now && now <= end;
                    const availableInMs = Math.trunc(Math.max(0, start - now) / 1000) * 1000;
                    const availableIn = _format_duration(availableInMs, 2);

                    const content = `
                        <div class="ui column">
                            <div style="height: 240px; background: ${PET_COLORS[Math.trunc(index / 20)]}; color: black; border-radius: 0.25em;" class="p-4 flex flex-col items-center justify-content-between text-center pet-hoverable cursor-pointer">
                                <b>${availableNow ? `<i class="ui check icon"></i> ${intl('pets.available')}` : `<i class="ui clock outline icon"></i> ${availableIn}`}</b>
                                <img class="ui centered image" style="margin: 0.5em; width: 100px; height: 100px;" src="res/pets/monster${index + 800}.png">
                                <h2 class="ui header" style="margin: 0;">${intl(`pets.names.${index}`)}</h2>
                                <span>${intl(`pets.locations.${location}`)}</span>
                                <div class="pet-hover flex flex-col justify-content-center items-center">
                                    <div>${intl(`pets.descriptions.${index}`)}</div>
                                </div>
                            </div>
                        </div>
                    `;

                    entries.push({
                        availableInMs,
                        content
                    });
                }

                $petGrid.html(_sort_asc(entries, (entry) => entry.availableInMs).map((entry) => entry.content).join(''))
            });
        </script>
    </body>
</html>
